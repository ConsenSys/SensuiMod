machine:
  node:
    version: v6.11.4
  services:
    - docker

dependencies:
  pre:
    - sudo apt-get update
  override:
    - npm install --no-optional
    - npm install -g serverless@1.24.1

test:
  override:
    - docker build -t testdb -f circle.Dockerfile .
    - docker run -p 5432:5432 --rm --name pg-test testdb

deployment:
  develop:
    branch:
      - ch6296/ci-cd
    commands:
    - sls deploy --stage develop
  master:
    branch:
      - master
    commands:
      - sls deploy --stage master
